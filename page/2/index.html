<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>zhangyong</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="zhangyong">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="zhangyong">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="zhangyong">
  
    <link rel="alternative" href="/atom.xml" title="zhangyong" type="application/atom+xml">
  
  
    <link rel="icon" href="http://7xkj1z.com1.z0.glb.clouddn.com/head.jpg">
  
  <link rel="stylesheet" href="/css/style.css">
  
  

  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
</head></html>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://avatars0.githubusercontent.com/u/39975746?s=400&amp;u=5c82d9ef34c547270f3fbe1d343a296e3ebdce25&amp;v=4" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">zhangyong</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/smackgg/hexo-theme-smackdown">smackdown</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">zhangyong</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://avatars0.githubusercontent.com/u/39975746?s=400&amp;u=5c82d9ef34c547270f3fbe1d343a296e3ebdce25&amp;v=4" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">zhangyong</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-golang/golang包管理工具" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/03/18/golang/golang包管理工具/" class="article-date">
  	<time datetime="2020-03-18T10:43:55.000Z" itemprop="datePublished">2020-03-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/18/golang/golang包管理工具/">
        go包管理工具小结
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="go-dep"><a href="#go-dep" class="headerlink" title="go dep"></a>go dep</h1><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>执行以下命令安装<code>godep</code>工具。</p>
<pre><code>go get github.com/tools/godep</code></pre><h3 id="基本命令"><a href="#基本命令" class="headerlink" title="基本命令"></a>基本命令</h3><p>安装好<code>godep</code>之后，在终端输入<code>godep</code>查看支持的所有命令。</p>
<pre><code>godep save     将依赖项输出并复制到Godeps.json文件中
godep go       使用保存的依赖项运行go工具
godep get      下载并安装具有指定依赖项的包
godep path     打印依赖的GOPATH路径
godep restore  在GOPATH中拉取依赖的版本
godep update   更新选定的包或go版本
godep diff     显示当前和以前保存的依赖项集之间的差异
godep version  查看版本信息</code></pre><p>使用<code>godep help [command]</code>可以看看具体命令的帮助信息。</p>
<p>使用godep<br>在项目目录下执行godep save命令，会在当前项目中创建Godeps和vender两个文件夹。</p>
<p>其中Godeps文件夹下有一个Godeps.json的文件，里面记录了项目所依赖的包信息。 vender文件夹下是项目依赖的包的源代码文件。</p>
<h3 id="go-dep开发流程"><a href="#go-dep开发流程" class="headerlink" title="go dep开发流程"></a>go dep开发流程</h3><p>保证程序能够正常编译</p>
<p>执行<code>godep save</code>保存当前项目的所有第三方依赖的版本信息和代码</p>
<p>提交<code>Godeps</code>目录和<code>vender</code>目录到代码库。</p>
<p>如果要更新依赖的版本，可以直接修改<code>Godeps.json</code>文件中的对应项</p>
<h3 id="vender机制"><a href="#vender机制" class="headerlink" title="vender机制"></a>vender机制</h3><p>Go1.5版本之后开始支持，能够控制Go语言程序编译时依赖包搜索路径的优先级。</p>
<p>例如查找项目的某个依赖包，首先会在项目根目录下的<code>vender</code>文件夹中查找，如果没有找到就会去<code>$GOAPTH/src</code>目录下查找。</p>
<p>##go module<br>go module是Go1.11版本之后官方推出的版本管理工具，并且从Go1.13版本开始，go module将是Go语言默认的依赖管理工具。</p>
<h3 id="go-mod命令"><a href="#go-mod命令" class="headerlink" title="go mod命令"></a>go mod命令</h3><p>常用的go mod命令如下：</p>
<pre><code>go mod download    下载依赖的module到本地cache（默认为$GOPATH/pkg/mod目录）
go mod edit        编辑go.mod文件
go mod graph       打印模块依赖图
go mod init        初始化当前文件夹, 创建go.mod文件
go mod tidy        增加缺少的module，删除无用的module
go mod vendor      将依赖复制到vendor下
go mod verify      校验依赖
go mod why         解释为什么需要依赖

module用来定义包名
require用来定义依赖包及版本
indirect表示间接引用</code></pre><h3 id="GOPROXY"><a href="#GOPROXY" class="headerlink" title="GOPROXY"></a>GOPROXY</h3><p>GOPROXY 的默认值是：</p>
<pre><code>https://proxy.golang.org,direct</code></pre><p>这有一个很严重的问题，就是 <code>proxy.golang.org</code> 在国内是无法访问的，<br>因此这会直接卡住你的第一步，所以你必须在开启 Go modules 的时<br>，同时设置国内的 Go 模块代理，执行如下命令：</p>
<pre><code>$ go env -w GOPROXY=https://goproxy.cn,direct</code></pre><h3 id="命令行开启-Go-Modules"><a href="#命令行开启-Go-Modules" class="headerlink" title="命令行开启 Go Modules"></a>命令行开启 Go Modules</h3><p>目前 Go modules 并不是默认开启，因此Go语言提供了 GO111MODULE 这个环境变量来作为 Go modules 的开关，其允许设置以下参数：</p>
<ul>
<li>auto：只要项目包含了 go.mod 文件的话启用 Go modules，目前在Go1.11至 Go1.14 中仍然是默认值。</li>
<li>on：启用 Go modules，推荐设置，将会是未来版本中的默认值。</li>
<li>off：禁用 Go modules，不推荐设置。</li>
</ul>
<p>如果你不确定你当前的值是什么，可以执行go env命令，查看结果：</p>
<pre><code>$ go env
GO111MODULE=&quot;off&quot;</code></pre><p>如果需要对 GO111MODULE 的值进行变更，推荐通过go env命令进行设置：</p>
<pre><code>$ go env -w GO111MODULE=on</code></pre><h3 id="goland中启用go-module"><a href="#goland中启用go-module" class="headerlink" title="goland中启用go module"></a>goland中启用go module</h3><p><img src="//yoursite.com/2020/03/18/golang/golang包管理工具/golang%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/%E5%BC%80%E5%90%AFgomodule.png" alt></p>
<p>代理可以设置为：<code>https://goproxy.cn</code></p>
<h3 id="初始化项目"><a href="#初始化项目" class="headerlink" title="初始化项目"></a>初始化项目</h3><pre><code>go mod init</code></pre><h3 id="go-mod-文件"><a href="#go-mod-文件" class="headerlink" title="go.mod 文件"></a>go.mod 文件</h3><p>在初始化项目时，会生成一个 go.mod 文件，是启用了 Go modules 项目所必须的最重要的标识.</p>
<p>示例：</p>
<pre><code>module github.com/example
go 1.13

require (
    github.com/jinzhu/gorm v1.9.12 // indirect
)
exclude github.com/jinzhu/gorm v1.9.11
replace github.com/go-kit/kit v0.9.0 =&gt; github.com/go-kit/kit v0.8.0</code></pre><ul>
<li>module：用于定义当前项目的模块路径。</li>
<li>go：用于标识当前模块的 Go 语言版本，值为初始化模块时的版本，<code>升级golang版本时，要注意是否需要更改此处</code></li>
<li>require：用于设置一个特定的模块版本。</li>
<li>exclude：用于从使用中排除一个特定的模块版本。</li>
<li>replace：用于将一个模块版本替换为另外一个模块版本  </li>
</ul>
<h3 id="go-sum-文件"><a href="#go-sum-文件" class="headerlink" title="go.sum 文件"></a>go.sum 文件</h3><p>go.sum 文件详细罗列了当前项目直接或间接依赖的所有模块版本，并写明了那些模块版本的 SHA-256 哈希值以备 Go 在今后的操作中保证项目所依赖的那些模块版本不会被篡改。</p>
<pre><code>cloud.google.com/go v0.26.0/go.mod h1:aQUYkXzVsufM+DwF1aE+0xfcU+56JwCaLick0ClmMTw=
github.com/BurntSushi/toml v0.3.1 h1:WXkYYl6Yr3qBf1K79EBnL4mak0OimBfB0XUf9Vl28OQ=
github.com/BurntSushi/toml v0.3.1/go.mod h1:xHWCNGjB5oqiDr8zfno3MHue2Ht5sIBksp03qcyfWMU=
....</code></pre><p>h1 hash 是 Go modules 将目标模块版本的 zip 文件开包后，针对所有包内文件依次进行 hash，然后再把它们的 hash 结果按照固定格式和算法组成总的 hash 值。</p>
<p>而 h1 hash 和 go.mod hash 两者，要不就是同时存在，要不就是只存在 go.mod hash。那什么情况下会不存在 h1 hash 呢，就是当 Go 认为肯定用不到某个模块版本的时候就会省略它的 h1 hash，就会出现不存在 h1 hash，只存在 go.mod hash 的情况。</p>
<h2 id="替代包"><a href="#替代包" class="headerlink" title="替代包"></a>替代包</h2><p>在管理过程中，导入的包为 <code>0.9.0</code> 版本，实际需要<code>0.8.0</code>版本，需要将导入的<code>0.9.0</code>版本<br>用<code>replace</code>替代为 <code>0.8.0</code> 版本</p>
<pre><code>go 1.13

require (
    github.com/jinzhu/gorm v1.9.12 // indirect
)
replace github.com/go-kit/kit v0.9.0 =&gt; github.com/go-kit/kit v0.8.0</code></pre><p>也可以用命令行模式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go mod edit -replace=old[@v]=new[@v]</span><br></pre></td></tr></table></figure>

<h2 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h2><p><a href="https://mp.weixin.qq.com/s/nd8ic1Qk812ZqmHKSFITUQ" target="_blank" rel="noopener">学习 Go Modules 这一篇就够：终极入门</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-golang/golang面试题" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/03/18/golang/golang面试题/" class="article-date">
  	<time datetime="2020-03-18T10:43:55.000Z" itemprop="datePublished">2020-03-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/18/golang/golang面试题/">
        go 面试题小结
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="使用Go编程有什么好处？"><a href="#使用Go编程有什么好处？" class="headerlink" title="使用Go编程有什么好处？"></a>使用Go编程有什么好处？</h2><p>1 golang虽然不像jvm那样，一次构建，到处运行。但是golang支持跨平台编译，完全能够适应多平台。</p>
<p>2 内嵌C支持。Go里面也可以直接包含c代码，利用现有的丰富的C库。</p>
<p>3 gofmt，它根据 Go 的建议风格对代码进行格式化。</p>
<p>4 <code>goroutine</code>的轻量级线程，并通过<code>channel</code>进行通信。</p>
<p>5 golang 的调度机制</p>
<h2 id="Go支持类型继承吗？"><a href="#Go支持类型继承吗？" class="headerlink" title="Go支持类型继承吗？"></a>Go支持类型继承吗？</h2><p><a href="https://cloud.tencent.com/developer/news/411806" target="_blank" rel="noopener">Go语言中没有类继承，要用多态怎么办？</a></p>
<pre><code>type shape interface{

    hasArea（name string）bool

}

type square struct {

    length int

}

func （sq square）hasArea(type string) bool {

    if type == &quot;line&quot;

        return false

    else

        return true

}

使用的时候可以这样:

sq := square

fmt.Pringln（&quot;Has area?&quot;, sq.hasArea（））

或者这样

var sq shape

sq = square

fmt.Pringln（&quot;Has area?&quot;, sq.hasArea（））

从上面的例子可以看出，任何能够匹配以上接口中函数定义的结构对象， 
都可以使用这个接口类型。

这样做，就在go语言实现多态了。</code></pre><p>Go支持运营商超载吗？</p>
<h2 id="Go支持方法重载吗？"><a href="#Go支持方法重载吗？" class="headerlink" title="Go支持方法重载吗？"></a>Go支持方法重载吗？</h2><p>不支持</p>
<h2 id="Go支持指针算术吗？"><a href="#Go支持指针算术吗？" class="headerlink" title="Go支持指针算术吗？"></a>Go支持指针算术吗？</h2><p>golang虽说指针变量不能直接参与指针运算, 但是却提供了unsafe包, 能够实现同样的功能。</p>
<p><a href="https://www.jianshu.com/p/c5dd12522cc6" target="_blank" rel="noopener">Golang是否真的没有指针运算</a></p>
<h2 id="Go支持通用编程吗？"><a href="#Go支持通用编程吗？" class="headerlink" title="Go支持通用编程吗？"></a>Go支持通用编程吗？</h2><p>Go编程语言不支持通用/泛型编程</p>
<h2 id="Go是一个区分大小写的语言吗？"><a href="#Go是一个区分大小写的语言吗？" class="headerlink" title="Go是一个区分大小写的语言吗？"></a>Go是一个区分大小写的语言吗？</h2><p>区分：例如在方法名上，首字母大写表示方法为public,小写为私有方法</p>
<h2 id="Go中变量的静态类型声明是什么？Go中变量的动态类型声明是什么？"><a href="#Go中变量的静态类型声明是什么？Go中变量的动态类型声明是什么？" class="headerlink" title="Go中变量的静态类型声明是什么？Go中变量的动态类型声明是什么？"></a>Go中变量的静态类型声明是什么？Go中变量的动态类型声明是什么？</h2><p>静态类型(static type)是变量声明的时候的声明类型，<br>在变量声明、new方法创建对象时或者结构体(struct)的元素的类型定义，参数类型等。</p>
<p>接口(interface)类型的变量还有一个动态类型，它是运行时赋值给这个变量的具体的值的类型(当然值为nil的时候没有动态类型)。一个变量的动态类型在运行时可能改变，<br>这主要依赖它的赋值。</p>
<pre><code>var x interface{}  // x 为零值 nil,静态类型为 interface{}
var v *T           // v 为零值 nil, 静态类型为 *T
x = 42             // x 的值为 42,动态类型为int, 静态类型为interface{}
x = v              // x 的值为 (*T)(nil)， 动态类型为 *T, 静态类型为 *T</code></pre><h2 id="你能在Go中的单个声明中声明多种类型的变量吗？"><a href="#你能在Go中的单个声明中声明多种类型的变量吗？" class="headerlink" title="你能在Go中的单个声明中声明多种类型的变量吗？"></a>你能在Go中的单个声明中声明多种类型的变量吗？</h2><p>能</p>
<pre><code>var m, n int
a, b := &quot;a&quot;, &quot;b&quot;;

var(
   no  int
   name string
)</code></pre><h2 id="如何在Go中打印变量的类型？"><a href="#如何在Go中打印变量的类型？" class="headerlink" title="如何在Go中打印变量的类型？"></a>如何在Go中打印变量的类型？</h2><pre><code>第一种方式，反射：
fmt.Println(reflect.TypeOf(var)) 

第二种方式， %T
var a, b, c = 3, 4, &quot;foo&quot;    
fmt.Printf(&quot;a is of type %T\n&quot;, a)</code></pre><p>什么是指针？</p>
<h2 id="break语句的目的是什么？"><a href="#break语句的目的是什么？" class="headerlink" title="break语句的目的是什么？"></a>break语句的目的是什么？</h2><pre><code>break：跳出for循环;break在switch（开关语句）中在执行一条case后跳出语句的作用
continue:跳过当前循环执行下一次循环语句</code></pre><p><a href="https://blog.csdn.net/mofiu/article/details/77318376" target="_blank" rel="noopener">golang跳转语句goto,break,continue的使用及区别</a></p>
<p>继续声明的目的是什么？</p>
<h2 id="goto语句的目的是什么？"><a href="#goto语句的目的是什么？" class="headerlink" title="goto语句的目的是什么？"></a>goto语句的目的是什么？</h2><pre><code>goto可以跳出多层嵌套循环，
for，while，dowhile本质是用goto语句实现的，goto语句比较底层</code></pre><p>除非跳出多个循环嵌套和远程注入技术，否则尽量少用goto</p>
<p>goto会降低程序的可读性，让代码难以调试</p>
<p> 利用递归也可以实现循环结构和do while类似</p>
<p><a href="https://www.cnblogs.com/luoxuw/p/11257788.html" target="_blank" rel="noopener">goto语句的本质</a></p>
<h2 id="解释’for’循环的语法。"><a href="#解释’for’循环的语法。" class="headerlink" title="解释’for’循环的语法。"></a>解释’for’循环的语法。</h2><p><a href="https://blog.csdn.net/guofeng93/article/details/90804430" target="_blank" rel="noopener">https://blog.csdn.net/guofeng93/article/details/90804430</a></p>
<h2 id="解释在Go中创建函数的语法。"><a href="#解释在Go中创建函数的语法。" class="headerlink" title="解释在Go中创建函数的语法。"></a>解释在Go中创建函数的语法。</h2><pre><code>func function_name( [parameter list] ) [return_types] {
   函数体
}</code></pre><h2 id="你能从函数中返回多个值吗？"><a href="#你能从函数中返回多个值吗？" class="headerlink" title="你能从函数中返回多个值吗？"></a>你能从函数中返回多个值吗？</h2><p>能</p>
<pre><code>func (file *File) Read(b []byte) (n int, err Error) </code></pre><p>您可以将参数传递给方法的方式有多少？</p>
<p>将参数传递给函数的默认方式是什么？</p>
<h2 id="Go中的函数作为值是什么意思？"><a href="#Go中的函数作为值是什么意思？" class="headerlink" title="Go中的函数作为值是什么意思？"></a>Go中的函数作为值是什么意思？</h2><p>在Go中函数也是一种变量，我们可以通过type来定义它，<br>它的类型就是所有拥有相同的参数，相同的返回值的一种类型</p>
<pre><code>type typeName func(input1 inputType1 , input2 inputType2 [, ...]) (result1 resultType1 [, ...])</code></pre><h2 id="什么是功能关闭？"><a href="#什么是功能关闭？" class="headerlink" title="什么是功能关闭？"></a>什么是功能关闭？</h2><p>定义的或内置的可调用函数</p>
<p>Go中的方法是什么？</p>
<p>Go中局部变量的默认值是多少？</p>
<p>Go中全局变量的默认值是多少？</p>
<h2 id="Go中指针变量的默认值是多少？"><a href="#Go中指针变量的默认值是多少？" class="headerlink" title="Go中指针变量的默认值是多少？"></a>Go中指针变量的默认值是多少？</h2><p>在go语言中，任何类型在声明后没有赋值的情况下，都对应一个零值。</p>
<pre><code>整形如int8、byte、int16、uint、uintprt等，默认值为0。
浮点类型如float32、float64，默认值为0。
布尔类型bool的默认值为false。
复数类型如complex64、complex128，默认值为0+0i。
字符串string的默认值为”“。
错误类型error的默认值为nil。
对于一些复合类型，如指针、切片、字典、通道、接口，默认值为nil。
而数组的默认值要根据其数据类型来确定。
例如：var a [4]int，其默认值为[0 0 0 0]。</code></pre><h2 id="解释Printf（）函数的用途。"><a href="#解释Printf（）函数的用途。" class="headerlink" title="解释Printf（）函数的用途。"></a>解释Printf（）函数的用途。</h2><p>格式化输出。</p>
<p>什么是左值和左值？</p>
<p>实际和形式参数之间有什么区别？</p>
<p>变量声明和变量定义有什么区别？</p>
<p>解释模块化编程。</p>
<p>什么是令牌？</p>
<p>哪个关键字用于执行无条件分支？</p>
<p>什么是阵列？</p>
<p>Go中的零指针是什么？</p>
<p>指针上的指针是什么？</p>
<p>Go的结构是什么？</p>
<p>如何在Go中定义一个结构？</p>
<p>Go中的切片是什么？</p>
<p>如何在Go中定义切片？</p>
<p>如何获取切片中存在的元素数？</p>
<p>Go中slice的len（）和cap（）函数有什么区别？</p>
<p>长度 、容量</p>
<p>如何获得切片的子切片？</p>
<p>Go的范围是什么？</p>
<p>Go中的map是什么？</p>
<p>如何在Go中创建map？</p>
<p>如何从Go中删除map中的条目？</p>
<p>什么是Go中的类型转换？</p>
<p>Go中的接口是什么？</p>
<p>垃圾回收</p>
<p>逃逸分析</p>
<p>除了 mutex 以外还有那些方式安全读写共享变量？</p>
<h2 id="channel"><a href="#channel" class="headerlink" title="channel"></a>channel</h2><h3 id="1-无缓冲-chan-的发送和接收是否同步？"><a href="#1-无缓冲-chan-的发送和接收是否同步？" class="headerlink" title="1 无缓冲 chan 的发送和接收是否同步？"></a>1 无缓冲 chan 的发送和接收是否同步？</h3><p>ch := make(chan int) 无缓冲的channel由于没有缓冲发送和接收需要同步.</p>
<p>ch := make(chan int, 2) 有缓冲channel不要求发送和接收操作同步</p>
<p>仅当信道的缓冲区填满后，向其发送数据时才会阻塞（阻塞写）。<br>当缓冲区为空时，接受方会阻塞（阻塞读）</p>
<h3 id="2-channel-是通过注册-goroutine-id-实现？"><a href="#2-channel-是通过注册-goroutine-id-实现？" class="headerlink" title="2 channel 是通过注册 goroutine id 实现？"></a>2 channel 是通过注册 goroutine id 实现？</h3><p>是</p>
<h3 id="3-如何用channel实现一个令牌桶"><a href="#3-如何用channel实现一个令牌桶" class="headerlink" title="3 如何用channel实现一个令牌桶"></a>3 如何用channel实现一个令牌桶</h3><p><a href="https://www.jianshu.com/p/a6129c70f7d4" target="_blank" rel="noopener">go 令牌桶简易实现</a></p>
<p>令牌桶算法的基本过程如下：</p>
<ul>
<li>假如用户配置的平均发送速率为r，则每隔1/r秒一个令牌被加入到桶中；</li>
<li>假设桶最多可以存发b个令牌。如果令牌到达时令牌桶已经满了，那么这个令牌会被丢弃；</li>
<li>当一个n个字节的数据包到达时，就从令牌桶中删除n个令牌，并且数据包被发送到网络；</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">    &quot;fmt&quot;</span><br><span class="line">    &quot;sync&quot;</span><br><span class="line">    &quot;time&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">type Bucket struct &#123;</span><br><span class="line">    cap   int //容量</span><br><span class="line">    ch    chan bool   </span><br><span class="line">    timer *time.Ticker //定时填充token</span><br><span class="line">    mu    sync.Mutex</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func NewBucket(cap int, interval time.Duration) *Bucket &#123;</span><br><span class="line">    bucket := &amp;Bucket&#123;</span><br><span class="line">        cap:   cap,</span><br><span class="line">        ch:    make(chan bool, cap),</span><br><span class="line">        timer: time.NewTicker(interval),</span><br><span class="line">    &#125;</span><br><span class="line">    go bucket.startTicker()</span><br><span class="line">    return bucket</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (bucket *Bucket) startTicker() &#123;</span><br><span class="line">    for i := 0; i &lt; bucket.cap; i++ &#123;</span><br><span class="line">        bucket.ch &lt;- true</span><br><span class="line">    &#125;</span><br><span class="line">    for &#123;</span><br><span class="line">        select &#123;</span><br><span class="line">        case &lt;-bucket.timer.C:</span><br><span class="line">            for i := len(bucket.ch); i &lt; bucket.cap; i++ &#123;</span><br><span class="line">                bucket.Add()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (bucket *Bucket) Add() &#123;</span><br><span class="line">    bucket.mu.Lock()</span><br><span class="line">    defer bucket.mu.Unlock()</span><br><span class="line">    if len(bucket.ch) &lt; bucket.cap &#123;</span><br><span class="line">        bucket.ch &lt;- true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (bucket *Bucket) Get() bool &#123;</span><br><span class="line">    select &#123;</span><br><span class="line">    case &lt;-bucket.ch:</span><br><span class="line">        return true</span><br><span class="line">    default:</span><br><span class="line">        return false</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line"></span><br><span class="line">    bucket := NewBucket(5, time.Second)</span><br><span class="line">    for i := 0; i &lt; 1000; i++ &#123;</span><br><span class="line">        time.Sleep(time.Millisecond * 100)</span><br><span class="line">        go DoFunc(bucket, i)</span><br><span class="line">    &#125;</span><br><span class="line">    for &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func DoFunc(bucket *Bucket, index int) &#123;</span><br><span class="line">    if bucket.Get() &#123;</span><br><span class="line">        fmt.Printf(&quot;######### success : %d \n&quot;, index)</span><br><span class="line">        bucket.Add() // 每次请求成功后执行Add是否合理？？？每一时刻最多可有cap个token可用</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        fmt.Printf(&quot;######### failed : %d \n&quot;, index)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="golang-采用什么并发模型？体现在哪里？"><a href="#golang-采用什么并发模型？体现在哪里？" class="headerlink" title="golang 采用什么并发模型？体现在哪里？"></a>golang 采用什么并发模型？体现在哪里？</h2><p><a href="https://www.jianshu.com/p/6032f2db6be5" target="_blank" rel="noopener">Golang并发模型</a></p>
<p>说说 golang 中常用的并发模式？</p>
<p>JSON 标准库对 nil slice 和 空 slice 的处理是一致的吗？</p>
<p>Go程序能链接C/C++程序吗</p>
<p>为什么Go没有泛型</p>
<h2 id="为什么Go没有异常"><a href="#为什么Go没有异常" class="headerlink" title="为什么Go没有异常"></a>为什么Go没有异常</h2><p>因为go开发者认为，所有异常皆可打印。</p>
<p>为什么用CSP思想构建并发如何知道变量分配到堆还是栈</p>
<p>为什么没有goroutine ID</p>
<p>restful熟悉吗？都有哪些请求方法，分别代表什么意思？</p>
<p>手写循环队列进程虚拟空间分布，全局变量放哪里？</p>
<p>c++ 和 go对比</p>
<p>怎么理解云计算</p>
<p>go使用踩过什么坑</p>
<p>go内存模型，什么是小对象，go get，go tool，go test，go vetgo什么情况下会发生内存泄漏？</p>
<h2 id="go为什么高并发好？"><a href="#go为什么高并发好？" class="headerlink" title="go为什么高并发好？"></a>go为什么高并发好？</h2><p>Golang 从语言级别支持并发，通过轻量级协程 Goroutine 来实现程序并发运行。</p>
<p>** Goroutine 非常轻量 **，主要体现在以下两个方面：</p>
<ul>
<li><p>上下文切换代价小： Goroutine 上下文切换只涉及到三个寄存器（PC / SP / DX）的值修改；<br>而对比线程的上下文切换则需要涉及模式切换（从用户态切换到内核态）、<br>以及 16 个寄存器、PC、SP…等寄存器的刷新；</p>
</li>
<li><p>内存占用少 ：线程栈空间通常是 2M，Goroutine 栈空间最小 2K；</p>
</li>
</ul>
<p>Golang 程序中可以轻松支持10w 级别的 Goroutine 运行，<br>而线程数量达到 1k 时，内存占用就已经达到 2G。</p>
<h2 id="Go语言-CPU-性能、内存分析调试方法大汇总"><a href="#Go语言-CPU-性能、内存分析调试方法大汇总" class="headerlink" title="Go语言 CPU 性能、内存分析调试方法大汇总"></a><a href="https://mp.weixin.qq.com/s/-HojlxCZZIcWWwprQaVkzw" target="_blank" rel="noopener">Go语言 CPU 性能、内存分析调试方法大汇总</a></h2><p>pprof</p>
<p>go的分布式</p>
<p>谈谈go的未来</p>
<p>gogc</p>
<h2 id="go的调度"><a href="#go的调度" class="headerlink" title="go的调度"></a>go的调度</h2><p> <a href="https://www.zhihu.com/question/21409296/answer/1040884859" target="_blank" rel="noopener">go调度器</a></p>
<h2 id="go-struct能不能比较-空struct-用处"><a href="#go-struct能不能比较-空struct-用处" class="headerlink" title="go struct能不能比较  空struct{}用处"></a>go struct能不能比较  空struct{}用处</h2><pre><code>因为是强类型语言，所以不同类型的结构不能作比较，
但是同一类型的实例值是可以比较的，实例不可以比较，因为是指针类型

map[inter]struct{}</code></pre><p>go defer（for defer）     </p>
<p>select可以用于什么 </p>
<pre><code>常用于gorotine的完美退出
golang 的 select 就是监听 IO 操作，当 IO 操作发生时，触发相应的动作
每个case语句里必须是一个IO操作，确切的说，应该是一个面向channel的IO操作    </code></pre><p>context包的用途     </p>
<p>client如何实现长连接     </p>
<pre><code>server是设置超时时间，for循环遍历的</code></pre><p>主协程如何等其余协程完再操作     </p>
<p>slice，len，cap，共享，扩容    </p>
<p>map如何顺序读取    </p>
<pre><code>map不能顺序读取，是因为他是无序的，想要有序读取，
首先的解决的问题就是，把ｋｅｙ变为有序，
所以可以把key放入切片，对切片进行排序，遍历切片，通过key取值。</code></pre><p>实现set     </p>
<pre><code>type inter interface{}
type Set struct {
    m map[inter]bool
    sync.RWMutex
}

func New() *Set {
    return &amp;Set{
    m: map[inter]bool{},
    }
}
func (s *Set) Add(item inter) {
    s.Lock()
    defer s.Unlock()
    s.m[item] = true
}</code></pre><p>实现消息队列（多生产者，多消费者）     </p>
<pre><code>使用切片加锁可以实现</code></pre><p>大文件排序     </p>
<pre><code>归并排序，分而治之,拆分为小文件，在排序</code></pre><p>基本排序，哪些是稳定的     </p>
<p>读写锁</p>
<h1 id="http"><a href="#http" class="headerlink" title="http"></a>http</h1><h2 id="1-http-get跟head"><a href="#1-http-get跟head" class="headerlink" title="1 http get跟head"></a>1 http get跟head</h2><pre><code>HEAD和GET本质是一样的，区别在于HEAD不含有呈现数据，
而仅仅是HTTP头信息。有的人可能觉得这个方法没什么用，
其实不是这样的。想象一个业务情景：欲判断某个资源是否存在，
我们通常使用GET，但这里用HEAD则意义更加明确。</code></pre><h2 id="2-http-401-403"><a href="#2-http-401-403" class="headerlink" title="2 http 401,403"></a>2 http 401,403</h2><pre><code>400 bad request，请求报文存在语法错误
401 unauthorized，表示发送的请求需要有通过 HTTP 认证的认证信息
403 forbidden，表示对请求资源的访问被服务器拒绝
404 not found，表示在服务器上没有找到请求的资源  </code></pre><h2 id="3-http-keep-alive"><a href="#3-http-keep-alive" class="headerlink" title="3 http keep-alive"></a>3 http keep-alive</h2><pre><code>client发出的HTTP请求头需要增加Connection:keep-alive字段
Web-Server端要能识别Connection:keep-alive字段，
并且在http的response里指定Connection:keep-alive字段，
告诉client，我能提供keep-alive服务，
并且&quot;应允&quot;client我暂时不会关闭socket连接</code></pre><h2 id="4-http能不能一次连接多次请求，不等后端返回"><a href="#4-http能不能一次连接多次请求，不等后端返回" class="headerlink" title="4 http能不能一次连接多次请求，不等后端返回"></a>4 http能不能一次连接多次请求，不等后端返回</h2><pre><code>http本质上市使用socket连接，因此发送请求，接写入tcp缓冲，
是可以多次进行的，这也是http是无状态的原因   </code></pre><h2 id="5-tcp与udp区别，udp优点，适用场景"><a href="#5-tcp与udp区别，udp优点，适用场景" class="headerlink" title="5 tcp与udp区别，udp优点，适用场景"></a>5 tcp与udp区别，udp优点，适用场景</h2><pre><code>tcp传输的是数据流，而udp是数据包，tcp会进过三次握手，udp不需要</code></pre><h2 id="6-time-wait的作用-服务产生大量的time-wait如何解决"><a href="#6-time-wait的作用-服务产生大量的time-wait如何解决" class="headerlink" title="6 time-wait的作用     服务产生大量的time_wait如何解决"></a>6 time-wait的作用     服务产生大量的time_wait如何解决</h2><p><a href="https://www.jianshu.com/p/41f7e468f312" target="_blank" rel="noopener">https://www.jianshu.com/p/41f7e468f312</a></p>
<pre><code>如果服务器最后发送的ACK因为某种原因丢失了，那么客户一定会重新发送FIN，
这样因为有TIME_WAIT的存在，服务器会重新发送ACK给客户，
如果没有TIME_WAIT，那么无论客户有没有收到ACK，服务器都已经关掉连接了，
此时客户重新发送FIN，服务器将不会发送ACK，而是RST，从而使客户端报错

如果没有TIME_WAIT，我们可以在最后一个ACK还未到达客户的时候，
就建立一个新的连接。那么此时，如果客户收到了这个ACK的话，就乱套了，
必须保证这个ACK完全死掉之后，才能建立新的连接。


在应用中通过设置合理的连接池参数可以避免TIME_WAIT状态过多的问题
比如 http  redis  grpc  mysql...</code></pre><h1 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h1><h2 id="1-索引"><a href="#1-索引" class="headerlink" title="1 索引"></a>1 索引</h2><h2 id="2-锁"><a href="#2-锁" class="headerlink" title="2 锁"></a>2 锁</h2><h2 id="3-事务"><a href="#3-事务" class="headerlink" title="3 事务"></a>3 事务</h2><p>幻读，一致性，CAP</p>
<h2 id="4-持久化"><a href="#4-持久化" class="headerlink" title="4 持久化"></a>4 持久化</h2><h1 id="redis"><a href="#redis" class="headerlink" title="redis"></a>redis</h1><h2 id="1-持久化"><a href="#1-持久化" class="headerlink" title="1 持久化"></a>1 持久化</h2><h2 id="2-分布式锁"><a href="#2-分布式锁" class="headerlink" title="2 分布式锁"></a>2 分布式锁</h2><h2 id="3-sorted-set"><a href="#3-sorted-set" class="headerlink" title="3 sorted set"></a>3 sorted set</h2><h1 id="mq"><a href="#mq" class="headerlink" title="mq"></a>mq</h1><h2 id="1-重复消费"><a href="#1-重复消费" class="headerlink" title="1 重复消费"></a>1 重复消费</h2><h2 id="2-保证不丢失消息"><a href="#2-保证不丢失消息" class="headerlink" title="2 保证不丢失消息"></a>2 保证不丢失消息</h2><p>孤儿进程，僵尸进程     </p>
<p>死锁条件，如何避免     </p>
<p>linux命令，查看端口占用，cpu负载，内存占用，如何发送信号给一个进程     </p>
<p>git文件版本，使用顺序，merge跟rebase</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-golang/go数据类型" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/03/18/golang/go数据类型/" class="article-date">
  	<time datetime="2020-03-18T10:43:55.000Z" itemprop="datePublished">2020-03-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/18/golang/go数据类型/">
        go数据类型小结
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://www.cnblogs.com/itbsl/p/9854681.html" target="_blank" rel="noopener">https://www.cnblogs.com/itbsl/p/9854681.html</a></p>
<h1 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h1><h2 id="整型"><a href="#整型" class="headerlink" title="整型"></a>整型</h2><p>无符号整型：<code>uint8</code>、<code>uint16</code>、<code>uint32</code>、<code>uint64</code></p>
<p>带符号整型：<code>int8</code> <code>int16</code> <code>int32</code> <code>int64</code></p>
<p><code>uint</code>和<code>int</code>具体是32位还是64位看操作系统</p>
<h2 id="浮点型"><a href="#浮点型" class="headerlink" title="浮点型"></a>浮点型</h2><p>float32和float64 </p>
<p>Go语言中浮点数默认是float64</p>
<h2 id="复数"><a href="#复数" class="headerlink" title="复数"></a>复数</h2><p>complex128和complex64</p>
<h2 id="布尔值"><a href="#布尔值" class="headerlink" title="布尔值"></a>布尔值</h2><p>boolean</p>
<p>##字符串<br>string</p>
<h2 id="byte和rune类型"><a href="#byte和rune类型" class="headerlink" title="byte和rune类型"></a>byte和rune类型</h2><p>go语言中字符串都是UTF-8编码，UTF-8编码中一个常用汉字一般占3个字符</p>
<p>由于rune可表示的范围更大，所以能处理一切字符，当然也包括中文字符。在平时计算中文字符，可用rune。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">func main() &#123;</span><br><span class="line">    var chinese = &quot;我是中国人， I am Chinese&quot;</span><br><span class="line">    fmt.Println(&quot;chinese length&quot;, len(chinese))</span><br><span class="line">    fmt.Println(&quot;chinese word length&quot;, len([]rune(chinese)))</span><br><span class="line">    fmt.Println(&quot;chinese word length&quot;, utf8.RuneCountInString(chinese))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//输出，注意在golang中一个汉字占3个byte</span><br><span class="line">chinese length 31</span><br><span class="line">chinese word length 19</span><br><span class="line">chinese word length 19</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-golang/go跨平台编译" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/03/18/golang/go跨平台编译/" class="article-date">
  	<time datetime="2020-03-18T10:43:55.000Z" itemprop="datePublished">2020-03-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/18/golang/go跨平台编译/">
        go跨平台编译小结
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>#1、跨平台编译<br><a href="https://studygolang.com/articles/20471" target="_blank" rel="noopener">https://studygolang.com/articles/20471</a></p>
<h2 id="windows平台下编译linux可执行文件："><a href="#windows平台下编译linux可执行文件：" class="headerlink" title="windows平台下编译linux可执行文件："></a>windows平台下编译linux可执行文件：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SET CGO_ENABLED=0 //禁用CGO</span><br><span class="line">SET GOOS=linux //目标平台是linux</span><br><span class="line">SET GOARCH=amd64 // 目标处理器架构是amd64</span><br></pre></td></tr></table></figure>

<p>再执行 ‘go bulid’ 命令，就可以得到在linux平台运行的可执行文件了</p>
<h2 id="Mac-下编译-Linux-和windows平台64位可执行文件"><a href="#Mac-下编译-Linux-和windows平台64位可执行文件" class="headerlink" title="Mac 下编译 Linux 和windows平台64位可执行文件"></a>Mac 下编译 Linux 和windows平台64位可执行文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CGO_ENABLED=0 </span><br><span class="line">GOOS=darwin </span><br><span class="line">GOARCH=amd64</span><br><span class="line">go bulid</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CGO_ENABLED=0 </span><br><span class="line">GOOS=windows </span><br><span class="line">GOARCH=amd64</span><br><span class="line">go bulid</span><br></pre></td></tr></table></figure>

<h2 id="windows下编译Mac平台64位可执行文件"><a href="#windows下编译Mac平台64位可执行文件" class="headerlink" title="windows下编译Mac平台64位可执行文件"></a>windows下编译Mac平台64位可执行文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CGO_ENABLED=0 </span><br><span class="line">GOOS=darwin </span><br><span class="line">GOARCH=amd64</span><br><span class="line">go bulid</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-golang/protocol-buffer" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/03/18/golang/protocol-buffer/" class="article-date">
  	<time datetime="2020-03-18T10:43:55.000Z" itemprop="datePublished">2020-03-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/18/golang/protocol-buffer/">
        go protocol-buffer小结
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://blog.csdn.net/mzpmzk/article/details/80824839" target="_blank" rel="noopener">https://blog.csdn.net/mzpmzk/article/details/80824839</a></p>
<p>Source: <a href="https://github.com/halfrost/Halfrost-Field/blob/master/contents/Protocol/Protocol-buffers-decode.md" target="_blank" rel="noopener">https://github.com/halfrost/Halfrost-Field/blob/master/contents/Protocol/Protocol-buffers-decode.md</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-golang/初探 Go 的编译命令执行过程" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/03/18/golang/初探 Go 的编译命令执行过程/" class="article-date">
  	<time datetime="2020-03-18T10:43:55.000Z" itemprop="datePublished">2020-03-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/18/golang/初探 Go 的编译命令执行过程/">
        go编译命令执行过程小结
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://www.jianshu.com/p/35a4ec1b3067" target="_blank" rel="noopener">https://www.jianshu.com/p/35a4ec1b3067</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-golang/利用goland搭建gin框架" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/03/18/golang/利用goland搭建gin框架/" class="article-date">
  	<time datetime="2020-03-18T10:43:55.000Z" itemprop="datePublished">2020-03-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/18/golang/利用goland搭建gin框架/">
        gin框架搭建小结
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>##1 go gin</p>
<p>##2 安装</p>
<p><a href="https://gin-gonic.com/zh-cn/docs/" target="_blank" rel="noopener">gin-gonic</a></p>
<p><a href="https://github.com/gin-gonic/gin" target="_blank" rel="noopener">gin</a></p>
<pre><code>go get -u github.com/gin-gonic/gin</code></pre><p>##3 导入<br>    package main</p>
<pre><code>import &quot;github.com/gin-gonic/gin&quot;

func main() {
    r := gin.Default()
    r.GET(&quot;/ping&quot;, func(c *gin.Context) {
        c.JSON(200, gin.H{
            &quot;message&quot;: &quot;pong&quot;,
        })
    })
    r.Run() // listen and serve on 0.0.0.0:8080 (for windows &quot;localhost:8080&quot;)
}</code></pre><p>##4 API Examples</p>
<p>Using GET, POST, PUT, PATCH, DELETE and OPTIONS</p>
<pre><code>func main() {
    // Creates a gin router with default middleware:
    // logger and recovery (crash-free) middleware
    router := gin.Default()

    router.GET(&quot;/someGet&quot;, getting)
    router.POST(&quot;/somePost&quot;, posting)
    router.PUT(&quot;/somePut&quot;, putting)
    router.DELETE(&quot;/someDelete&quot;, deleting)
    router.PATCH(&quot;/somePatch&quot;, patching)
    router.HEAD(&quot;/someHead&quot;, head)
    router.OPTIONS(&quot;/someOptions&quot;, options)

    // By default it serves on :8080 unless a
    // PORT environment variable was defined.
    router.Run()
    // router.Run(&quot;:3000&quot;) for a hard coded port
}</code></pre><p>Parameters in path</p>
<pre><code>func main() {
    router := gin.Default()

    // This handler will match /user/john but will not match /user/ or /user
    router.GET(&quot;/user/:name&quot;, func(c *gin.Context) {
        name := c.Param(&quot;name&quot;)
        c.String(http.StatusOK, &quot;Hello %s&quot;, name)
    })

    // However, this one will match /user/john/ and also /user/john/send
    // If no other routers match /user/john, it will redirect to /user/john/
    router.GET(&quot;/user/:name/*action&quot;, func(c *gin.Context) {
        name := c.Param(&quot;name&quot;)
        action := c.Param(&quot;action&quot;)
        message := name + &quot; is &quot; + action
        c.String(http.StatusOK, message)
    })

    // For each matched request Context will hold the route definition
    router.POST(&quot;/user/:name/*action&quot;, func(c *gin.Context) {
        c.FullPath() == &quot;/user/:name/*action&quot; // true
    })

    router.Run(&quot;:8080&quot;)
}</code></pre><p>Querystring parameters</p>
<pre><code>func main() {
    router := gin.Default()

    // Query string parameters are parsed using the existing underlying request object.
    // The request responds to a url matching:  /welcome?firstname=Jane&amp;lastname=Doe
    router.GET(&quot;/welcome&quot;, func(c *gin.Context) {
        firstname := c.DefaultQuery(&quot;firstname&quot;, &quot;Guest&quot;)
        lastname := c.Query(&quot;lastname&quot;) // shortcut for c.Request.URL.Query().Get(&quot;lastname&quot;)

        c.String(http.StatusOK, &quot;Hello %s %s&quot;, firstname, lastname)
    })
    router.Run(&quot;:8080&quot;)
}</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-mysql/mysql事务" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/03/18/mysql/mysql事务/" class="article-date">
  	<time datetime="2020-03-18T10:43:55.000Z" itemprop="datePublished">2020-03-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/18/mysql/mysql事务/">
        mysql事务
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1、原子性实现原理：Undo-log"><a href="#1、原子性实现原理：Undo-log" class="headerlink" title="1、原子性实现原理：Undo log"></a>1、原子性实现原理：Undo log</h1><pre><code>- Undo log是为了实现事务的原子性，在mysql数据库InnoDB存储引擎中，
还用Undo log来实现多版本并发控制（MVCC）
- 在操作任何数据之前，首先将数据备份到一个地方（这个存储数据备份的地方称为Undo log）.
然后进行数据修改。如果出现了错误或者用户执行了ROLLBACK语句，
系统可以利用undo log中的备份将数据恢复到事务之前的状态
- 注意：undo log是逻辑日志，可以理解为：
    - 当delete一条记录时，undo log中会记录一条对应的insert记录
    - 当insert一条记录时，undo log中会记录一条对应的delete记录
    - 当update一条记录时，undo log中会记录一条相反的update记录


（逻辑日志的意思是记录某一行数据的修改，物理日志是记录某一页的数据修改）</code></pre><h1 id="2、持久性原理：-Redo-log"><a href="#2、持久性原理：-Redo-log" class="headerlink" title="2、持久性原理： Redo log"></a>2、持久性原理： Redo log</h1><pre><code>- 和undo log相反，redo log记录的是新数据的备份。(异步写)
在事务提交前，只要将redo log持久化即可，不需要将数据持久化。
当系统崩溃时，虽然数据没有持久化，但是redo log已经持久化。
系统可以根据 redo log 的内容，将所有数据恢复到最新的状态
（innodb_flush_log_at_trx_commit）
WAL(write ahead log):预写日志</code></pre><p>当我们每次执行update,insert,delete等语句后，commit操作后，redo log执行持久化操作</p>
<p>innodb_flush_log_at_trx_commit = 0/1/2</p>
<pre><code>set global innodb_flush_log_at_trx_commit=2;
show variables like &apos;innodb_flush_log_at_trx_commit&apos;;</code></pre><p>默认值为：1</p>
<p>由于实时将数据刷到磁盘中，在并发条件下，性能较低，<br><img src="//yoursite.com/2020/03/18/mysql/mysql事务/mysql%E4%BA%8B%E5%8A%A1/1.png" alt></p>
<h1 id="3、mysql的隔离级别"><a href="#3、mysql的隔离级别" class="headerlink" title="3、mysql的隔离级别"></a>3、mysql的隔离级别</h1><ul>
<li>读未提交(read_uncommitted):对事务处理的读取没有任何限制；</li>
<li>读已提交(read_committed)：</li>
<li>可重复读(repeatable_read):默认级别</li>
<li>串行化(seriauzable)</li>
</ul>
<table>
<thead>
<tr>
<th align="center">事务的隔离级别</th>
<th align="center">脏读</th>
<th align="center">不可重复读</th>
<th align="center">幻读</th>
</tr>
</thead>
<tbody><tr>
<td align="center">读未提交(read_uncommitted)</td>
<td align="center">√</td>
<td align="center">√</td>
<td align="center">√</td>
</tr>
<tr>
<td align="center">读已提交(read_committed)</td>
<td align="center"></td>
<td align="center">√</td>
<td align="center">√</td>
</tr>
<tr>
<td align="center">可重复读(repeatable_read)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">√</td>
</tr>
<tr>
<td align="center">串行化(seriauzable)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody></table>
<h1 id="一致性"><a href="#一致性" class="headerlink" title="一致性"></a>一致性</h1><p>事务的并发执行，事务故障或系统故障  会对事务的一致性造成破坏</p>
<p>数据库系统通过并发控制技术和日志恢复技术来避免这种情况的发生：<br>    - 并发控制技术保证了事务的隔离性（加锁），使数据库的一致性状态不会<br>    因为并发执行的操作被破坏。<br>    - 日志恢复技术保证了事务的原子性，是一致性状态下不会因事务或系统故障被破坏。<br>    同时使已提交的对数据库的修改不会因为系统崩溃而丢失，保证了事务的持久性。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-mysql/mysql优化" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/03/18/mysql/mysql优化/" class="article-date">
  	<time datetime="2020-03-18T10:43:55.000Z" itemprop="datePublished">2020-03-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/18/mysql/mysql优化/">
        mysql优化
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>#1、选择优化的数据类型</p>
<p>##1 更小的通常更好<br>一般情况下，应该尽量使用可以正确存储数据的最小的数据类型</p>
<pre><code>例如只需要存储 `0-200`， `tinyint unsigned`更好一些</code></pre><p>更小的数据类型通常更快，因为它们占用更少的磁盘、内存和CPU缓存，并且处理时需要的CPU周期也更少</p>
<p>##2 简单就好<br>简单数据类型的操作通常需要更少的CPU周期。</p>
<pre><code>例如，整型比字符型操作代价更低，因为字符集和校对规则（排序规则）是字符比较比整型比较更复杂。
ex: 一个是应该使用Mysql内建的类型(date,time,datetime)而不是字符串来存储日期和时间，另外一个是应该用整型存储IP地。</code></pre><p>##3 尽量避免NULL<br>很多表都包含可为NULL的列，即使应用程序并不需要保存NULL也是如此，这是因为NULL是列的默认属性。<br>通常情况下最好指定列为NOT NULL，除非真的需要存储NULL值。</p>
<p>如果查询中包含可为NULL的列，对Mysql来说更难优化，因为可为NULL的列使得索引、索引统计和值比较都更复杂。<br>可为NULL的列会使用更多的存储空间，在Mysql中也需要特殊处理。当可为NULL的列被索引时，每个索引记录需要一个额外的字节，<br>在MyISAM里甚至还可能导致固定大小的索引（例如只有一个整数列的索引）变成可变大小的索引。<br>通常此项改动对于InnoDB的性能提升比较小。InnoDB使用单独的位（bit）存储NULL值，所以对于稀疏数据有很好的空间效率。    </p>
<h1 id="优化工具"><a href="#优化工具" class="headerlink" title="优化工具"></a>优化工具</h1><h2 id="explain"><a href="#explain" class="headerlink" title="explain"></a>explain</h2><p><a href="https://dev.mysql.com/doc/refman/5.7/en/explain-output.html" target="_blank" rel="noopener">explain-output</a></p>
<h2 id="show-profile"><a href="#show-profile" class="headerlink" title="show-profile"></a>show-profile</h2><p><a href="https://dev.mysql.com/doc/refman/5.7/en/show-profile.html" target="_blank" rel="noopener">show-profile</a></p>
<p><strong>* The SHOW PROFILE and SHOW PROFILES statements are deprecated and will be removed in a future MySQL release.<br>Use the Performance Schema instead; <a href="https://dev.mysql.com/doc/refman/5.7/en/performance-schema-query-profiling.html" target="_blank" rel="noopener">see Section 25.19.1, “Query Profiling Using Performance Schema”</a>. *</strong></p>
<pre><code>set profiling=1;
select * from student;
show profile for query 1;
show profile all for query 1;
show profile all for query 1\G               (后面没有分号！！！)

---------------------------------------

mysql&gt; set profiling=1;
Query OK, 0 rows affected, 1 warning (0.00 sec)

mysql&gt; select * from student;
+----+-----------+------+------+
| id | name      | age  | sex  |
+----+-----------+------+------+
|  1 | xiaoming  |   19 |    1 |
|  2 | xiaohong  |   18 |    0 |
|  3 | xiaolan   |   20 |    0 |
|  4 | xiaolv    |   20 |    0 |
|  5 | xiaohuang |   20 |    0 |
|  6 | 666       |   17 |    0 |
+----+-----------+------+------+
6 rows in set (0.00 sec)

mysql&gt; show profile for query 1;
+----------------------+----------+
| Status               | Duration |
+----------------------+----------+
| starting             | 0.000081 |
| checking permissions | 0.000011 |
| Opening tables       | 0.000019 |
| init                 | 0.000018 |
| System lock          | 0.000009 |
| optimizing           | 0.000006 |
| statistics           | 0.000016 |
| preparing            | 0.000013 |
| executing            | 0.000005 |
| Sending data         | 0.000056 |
| end                  | 0.000006 |
| query end            | 0.000009 |
| closing tables       | 0.000008 |
| freeing items        | 0.000013 |
| cleaning up          | 0.000016 |
+----------------------+----------+
15 rows in set, 1 warning (0.00 sec)

mysql&gt; show profile all for query 1;
+----------------------+----------+----------+------------+-------------------+---------------------+--------------+---------------+---------------+-------------------+-------------------+-------------------+-------+-----------------------+----------------------+-------------+
| Status               | Duration | CPU_user | CPU_system | Context_voluntary | Context_involuntary | Block_ops_in | Block_ops_out | Messages_sent | Messages_received | Page_faults_major | Page_faults_minor | Swaps | Source_function       | Source_file          | Source_line |
+----------------------+----------+----------+------------+-------------------+---------------------+--------------+---------------+---------------+-------------------+-------------------+-------------------+-------+-----------------------+----------------------+-------------+
| starting             | 0.000081 | 0.000032 |   0.000045 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | NULL                  | NULL                 |        NULL |
| checking permissions | 0.000011 | 0.000005 |   0.000006 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | check_access          | sql_authorization.cc |         809 |
| Opening tables       | 0.000019 | 0.000007 |   0.000010 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | open_tables           | sql_base.cc          |        5753 |
| init                 | 0.000018 | 0.000007 |   0.000011 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | handle_query          | sql_select.cc        |         128 |
| System lock          | 0.000009 | 0.000005 |   0.000006 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | mysql_lock_tables     | lock.cc              |         330 |
| optimizing           | 0.000006 | 0.000002 |   0.000004 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | optimize              | sql_optimizer.cc     |         158 |
| statistics           | 0.000016 | 0.000007 |   0.000009 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | optimize              | sql_optimizer.cc     |         374 |
| preparing            | 0.000013 | 0.000005 |   0.000008 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | optimize              | sql_optimizer.cc     |         482 |
| executing            | 0.000005 | 0.000002 |   0.000002 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | exec                  | sql_executor.cc      |         126 |
| Sending data         | 0.000056 | 0.000023 |   0.000033 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | exec                  | sql_executor.cc      |         202 |
| end                  | 0.000006 | 0.000002 |   0.000003 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | handle_query          | sql_select.cc        |         206 |
| query end            | 0.000009 | 0.000004 |   0.000006 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | mysql_execute_command | sql_parse.cc         |        4956 |
| closing tables       | 0.000008 | 0.000003 |   0.000004 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | mysql_execute_command | sql_parse.cc         |        5009 |
| freeing items        | 0.000013 | 0.000005 |   0.000008 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | mysql_parse           | sql_parse.cc         |        5622 |
| cleaning up          | 0.000016 | 0.000007 |   0.000008 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | dispatch_command      | sql_parse.cc         |        1931 |
+----------------------+----------+----------+------------+-------------------+---------------------+--------------+---------------+---------------+-------------------+-------------------+-------------------+-------+-----------------------+----------------------+-------------+
15 rows in set, 1 warning (0.00 sec)</code></pre><h2 id="Performance"><a href="#Performance" class="headerlink" title="Performance"></a>Performance</h2><p><a href="https://dev.mysql.com/doc/refman/5.7/en/performance-schema-quick-start.html" target="_blank" rel="noopener">performance-schema-quick-start</a></p>
<p><a href="https://dev.mysql.com/doc/refman/8.0/en/optimization.html" target="_blank" rel="noopener">https://dev.mysql.com/doc/refman/8.0/en/optimization.html</a></p>
<h1 id="分库分表"><a href="#分库分表" class="headerlink" title="分库分表"></a>分库分表</h1><p><a href="https://www.jianshu.com/p/5b2bb76d26d6" target="_blank" rel="noopener">分库分表</a></p>
<p><a href="https://www.bbsmax.com/A/xl56PpKYzr/" target="_blank" rel="noopener">mysql中间件分享（Mysql-prxoy,Atlas,DBProxy,Amoeba,cobar,TDDL）</a></p>
<h1 id="主从复制"><a href="#主从复制" class="headerlink" title="主从复制"></a>主从复制</h1><p><a href="https://blog.csdn.net/A_man_only/article/details/84257702" target="_blank" rel="noopener">MTS： 并行复制技术</a></p>
<h1 id="读写分离"><a href="#读写分离" class="headerlink" title="读写分离"></a>读写分离</h1>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-mysql/mysql使用存储过程脚本批量插入数据" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/03/18/mysql/mysql使用存储过程脚本批量插入数据/" class="article-date">
  	<time datetime="2020-03-18T10:43:55.000Z" itemprop="datePublished">2020-03-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/18/mysql/mysql使用存储过程脚本批量插入数据/">
        使用存储过程脚本批量插入数据
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="使用存储过程脚本批量插入数据"><a href="#使用存储过程脚本批量插入数据" class="headerlink" title="使用存储过程脚本批量插入数据"></a>使用存储过程脚本批量插入数据</h1><h3 id="创建数据库表："><a href="#创建数据库表：" class="headerlink" title="创建数据库表："></a>创建数据库表：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE bigtables (</span><br><span class="line">  `id` bigint(20) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `number` int(20) DEFAULT NULL,</span><br><span class="line">  `name` varchar(100) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8;</span><br></pre></td></tr></table></figure>

<h3 id="创建函数："><a href="#创建函数：" class="headerlink" title="创建函数："></a>创建函数：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">delimiter $$</span><br><span class="line">create function rand_string(n int) returns varchar(255)</span><br><span class="line">begin</span><br><span class="line">   declare chars_str varchar(100) default &apos;qwertyuiopasdfghjklzxcvbnm&apos;;</span><br><span class="line">   declare return_str varchar(255) default &apos;&apos;;</span><br><span class="line">   declare i int default 0;   </span><br><span class="line">   while i&lt;n do</span><br><span class="line">   set return_str=concat(return_str,substring(chars_str,floor(1+rand()*52),1));</span><br><span class="line">   set i=i+1;   </span><br><span class="line">   end while;   </span><br><span class="line">   return return_str; </span><br><span class="line">   end $$</span><br></pre></td></tr></table></figure>

<h3 id="创建产生随机的数字的函数"><a href="#创建产生随机的数字的函数" class="headerlink" title="创建产生随机的数字的函数"></a>创建产生随机的数字的函数</h3><p> 删除函数： <code>DROP  FUNCTION rand_num;</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">delimiter $$</span><br><span class="line">create <span class="function"><span class="keyword">function</span> <span class="title">rand_num</span><span class="params">()</span> <span class="title">returns</span> <span class="title">int</span><span class="params">(<span class="number">5</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">begin</span></span></span><br><span class="line"><span class="function"><span class="title">declare</span> <span class="title">i</span> <span class="title">int</span> <span class="title">default</span> 0</span>;</span><br><span class="line">set i=floor(<span class="number">100</span>+rand()*<span class="number">10</span>); </span><br><span class="line"><span class="keyword">return</span> i; end $$</span><br></pre></td></tr></table></figure>

<h2 id="创建存储过程"><a href="#创建存储过程" class="headerlink" title="创建存储过程"></a>创建存储过程</h2><p>删除存储过程： <code>drop procedure  insert_bigtables;</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">delimiter $$ </span><br><span class="line"><span class="function">create procedure <span class="title">insert_bigtables</span><span class="params">(in start <span class="keyword">int</span>(<span class="number">10</span>),in max_num <span class="keyword">int</span>(<span class="number">10</span>))</span></span></span><br><span class="line"><span class="function">begin </span></span><br><span class="line"><span class="function">declare i <span class="keyword">int</span>  <span class="keyword">default</span> 0</span>;</span><br><span class="line"><span class="built_in">set</span> autocommit = <span class="number">0</span>;</span><br><span class="line">repeat </span><br><span class="line"><span class="built_in">set</span> i = i +<span class="number">1</span>;</span><br><span class="line"><span class="function">insert into <span class="title">bigtables</span><span class="params">(id,number,name)</span> <span class="title">values</span><span class="params">((start+i),rand_num(),rand_string(<span class="number">6</span>))</span></span>;</span><br><span class="line">until i=max_num</span><br><span class="line">end repeat;</span><br><span class="line">commit;</span><br><span class="line">end $$</span><br></pre></td></tr></table></figure>

<h2 id="调用存储过程"><a href="#调用存储过程" class="headerlink" title="调用存储过程"></a><strong>调用存储过程</strong></h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">call <span class="title">insert_bigtables</span><span class="params">(<span class="number">100</span>,<span class="number">10</span>)</span></span>; </span><br><span class="line"><span class="comment">/*number大于100，插入10条数据*/</span></span><br></pre></td></tr></table></figure>

<h3 id="查看存储过程"><a href="#查看存储过程" class="headerlink" title="查看存储过程"></a>查看存储过程</h3><p><code>select name from mysql.proc where db = &#39;insert_bigtables&#39; and type = &#39;PROCEDURE&#39;;</code></p>
<p><code>SELECT * FROM information_schema.Routines WHERE  ROUTINE_NAME = &#39;insert_bigtables&#39; ;</code></p>
<p><code>SHOW CREATE PROCEDURE insert_bigtables;</code></p>
<p><code>SHOW CREATE FUNCTION rand_num;</code></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2020 zhangyong
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>